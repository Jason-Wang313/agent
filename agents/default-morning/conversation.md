# Conversation State — Current Session

<!--
PURPOSE: Tracks the current session's context and state.
This file is RESET at the start of each new session.
It is updated in real-time as the conversation progresses.
The app layer manages writes to this file.
-->

---

## SESSION METADATA

```
session_id:        [auto-generated by app layer]
date:              [YYYY-MM-DD]
start_time:        [HH:MM]
estimated_end:     [HH:MM, approx 5-10 min from start]
```

---

## CONTEXT INPUTS

<!-- Populated at session start by the runtime layer. -->
<!-- Weather and location are optional — only include if available. -->

```
day_of_week:       [Monday | Tuesday | Wednesday | Thursday | Friday | Saturday | Sunday]
time_bracket:      [early-morning | morning | late-morning]
                   early-morning  = before 7:00am
                   morning        = 7:00am–9:59am
                   late-morning   = 10:00am+
weather:           [description, or "unavailable"]
```

---

## CURRENT STATE

<!-- Updated after each exchange. Used by the agent to calibrate behaviour. -->

```
user_energy:            unknown
                        Values: groggy | neutral | chatty
                        Update after first 1-2 user messages.

turn_count:             0
                        Increment after each full exchange (agent turn + user turn).

topics_discussed:       []
                        Running list of topics that have come up this session.

memory_callbacks_used:  []
                        Which memory threads have been referenced this session.
                        Avoid repeating callbacks.

wrap_up_signalled:      false
                        Set to true when user signals they're getting up or ending the chat.
```

---

## ACTIVE PERSONA

```
persona_file:      agents/default-morning/persona.md
persona_name:      Sam
```

---

## CONVERSATION HISTORY

<!--
Rolling log of this session's exchanges.
Format: [SPEAKER]: [message]
Keep last 10 exchanges for context window efficiency — older turns can be dropped.
Agent should not reference turns older than what's in this window.
-->

### [Session not yet started]

<!-- On session start, the agent generates an opening message. -->
<!-- This section is populated by the app layer as the session progresses. -->

---

## WRAP-UP DETECTION

The agent should initiate a natural closing when ANY of the following are true:
- `turn_count` reaches 8 or more
- `wrap_up_signalled` is true
- User's responses become one-word or purely logistical ("yeah", "gotta go", "ok")
- User explicitly says they're leaving, starting work, heading out, etc.

Closing style: warm, brief, forward-looking. Not abrupt.
Example: "Go get it. Catch you tomorrow."
Never: task lists, reminders, productivity advice, guilt.
